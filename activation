#!/bin/bash

print_usage() {
  echo "Usage:"
  echo "  bash ./activation          # Copy all regular files from current directory to /usr/local/bin"
  echo "  bash ./activation -h|--help  # Show this help message"
}

if [[ "$1" == "-h" || "$1" == "--help" ]]; then
  print_usage
  exit 0
fi

# Find all regular files in current directory (non-recursive)
files=$(find . -maxdepth 1 -type f)

count=0
for file in $files; do
    filename=$(basename "$file")
    echo "Copying $file to /usr/local/bin/$filename ..."
    if sudo cp -f "$file" /usr/local/bin/"$filename"; then
        if sudo chmod +x /usr/local/bin/"$filename"; then
            echo "Successfully copied and made executable: $filename"
            ((count++))
        else
            echo "Error: Failed to make executable: $filename" >&2
        fi
    else
        echo "Error: Failed to copy $file" >&2
    fi
done

echo "Total files copied and made executable: $count"
